module Index where

import Text.Html

page =
  thehtml ! [theclass "with-topbar"] << [
    header << [
      meta ! [httpequiv "Content-Type", content "text/html; charset=UTF-8"],
      thelink ! [href "static/scaffold.css", rel "stylesheet",
                   thetype "text/css"] << noHtml,
      thetitle << "Barley"
      ],
    body << [
        h1 << "Barley: Welcome aboard!",
        p << "This is a first tutorial in Barley. Our aim is to make your \
             \first encounter with Haskell fun, enjoyable, and practical. " ,
        steps,
        thediv ! [identifier "topbar"] <<
            p << "Haskell | Platform | Hackage | λ Reddit | λ Stack Overflow"
        ]
    ]


type Step = (String, Html)

steps :: Html
steps = unordList $ map mkStep [step1, step2]
  where
    mkStep (title, text) = p << bold << title +++ thediv << text
    
step1 :: Step
step1 = ("Install and run Barley",
  p << "If you got here, you've done this step!"
  )

step2 :: Step
step2 = ("Try out your first page",
  p << ("There is a page called " +++
         anchor ! [ href "template" ] << "template" +++
         ". You should go look at it, and then come back here.") +++
  p << "That page is generated by a small program in the file named \
    \Template.hs in your project directory. Go open that in your \
    \favorite text editor. Try modifying it and saving it, then \
    \reload the template page to see the result." +++
  p << "Congratulations! You're writing Haskell!"
  )
 